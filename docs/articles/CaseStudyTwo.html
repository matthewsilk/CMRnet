<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case Study Two: Example of a multiplex movement network • CMRnet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Case Study Two: Example of a multiplex movement network">
<meta property="og:description" content="CMRnet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CMRnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CMRnet.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Information</li>
    <li>
      <a href="../articles/CMRnet_information.html">Detailed information on using CMRnet</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Case studies</li>
    <li>
      <a href="../articles/CaseStudyOne.html">Case Study One: Social behaviour during a badger lifetime</a>
    </li>
    <li>
      <a href="../articles/CaseStudyTwo.html">Case Study Two: Example of a multiplex movement network</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Case Study Two: Example of a multiplex movement network</h1>
                        <h4 class="author">Matthew Silk</h4>
            
            <h4 class="date">2020-07-03</h4>
      
      
      <div class="hidden name"><code>CaseStudyTwo.Rmd</code></div>

    </div>

    
    
<div id="example-using-cmrnet-to-generate-multiplex-movement-networks-of-european-badgers-to-provide-an-example-of-basic-onward-analysis-and-plotting" class="section level4">
<h4 class="hasAnchor">
<a href="#example-using-cmrnet-to-generate-multiplex-movement-networks-of-european-badgers-to-provide-an-example-of-basic-onward-analysis-and-plotting" class="anchor"></a>Example using CMRnet to generate multiplex movement networks of European badgers to provide an example of basic onward analysis and plotting</h4>
<hr>
</div>
<div id="background" class="section level4">
<h4 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h4>
<p>This case study is based on a long-term CMR dataset from a high-density population of European badgers in the United Kingdom (Delahay et al., 2013; McDonald, Robertson, &amp; Silk, 2018). Badgers in medium to high-density populations live in territorial social groups centred on a main sett (refuge/burrow system). The study population is trap-sampled four times per year (in May-June, July-August, September-October and December-January) using baited cage traps deployed at all know active sett locations (see McDonald et al., 2018 for more detail). Badgers give birth in late-winter (the date of birth of all cubs is assumed to be 1st February) and no trapping takes place while females have dependent cubs.</p>
<p>Here we demonstrate the multiplex movement network construction features of CMRnet using a subset badger capture dataset. We construct multiplex movement networks with layers that depict the movements of females and males separately. In this example we are not testing a particular hypothesis so much as demonstrating the use of the package in a visual exploration of movement network structure.</p>
<hr>
</div>
<div id="setup-and-data-manipulation" class="section level4">
<h4 class="hasAnchor">
<a href="#setup-and-data-manipulation" class="anchor"></a>Setup and data manipulation</h4>
<p>First we set up our environment.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lubridate</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">igraph</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">CMRnet</span>)</pre></body></html></div>
<p>The data we use here is not documented in the package, but can be accessed to recreate this analyses by using <code>CMRnet:::capturesData</code> and <code>CMRnet:::individualData</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># look at dimensions of data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">captures</span>)
<span class="co">#&gt; 'data.frame':    14461 obs. of  6 variables:</span>
<span class="co">#&gt;  $ tattoo     : chr  "Y001" "Y002" "G020" "B031" ...</span>
<span class="co">#&gt;  $ date       : chr  "10/06/1981" "10/06/1981" "11/06/1981" "12/06/1981" ...</span>
<span class="co">#&gt;  $ socg       : chr  "WEST" "SEPTIC TANK" "SEPTIC TANK" "SEPTIC TANK" ...</span>
<span class="co">#&gt;  $ sett       : chr  "WEST" "SEPTIC TANK" "SEPTIC TANK" "SEPTIC TANK" ...</span>
<span class="co">#&gt;  $ CaptureYear: int  1981 1981 1981 1981 1981 1981 1981 1981 1981 1981 ...</span>
<span class="co">#&gt;  $ where      : chr  "SETT" "SETT" "SETT" "SETT" ...</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">indivdat</span>)
<span class="co">#&gt; 'data.frame':    2975 obs. of  4 variables:</span>
<span class="co">#&gt;  $ tattoo : chr  "001A" "001B" "001E" "001F" ...</span>
<span class="co">#&gt;  $ age_fc : chr  "CUB" "ADULT" "CUB" "ADULT" ...</span>
<span class="co">#&gt;  $ year_fc: int  2014 2006 2013 2010 2003 2012 2011 2009 2008 2004 ...</span>
<span class="co">#&gt;  $ sex    : chr  "FEMALE" "MALE" "FEMALE" "MALE" ...</span></pre></body></html></div>
<p>We then do some data manipulation to fill in data on the age and sex of badgers in the captures data set. We also wrangle the date formats and create a dataframe in the format needed for <strong>CMRnet</strong>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">
<span class="no">captures</span>$<span class="no">sex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>))
<span class="no">captures</span>$<span class="no">age</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"ADULT"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>))

<span class="co"># Fill in data on the age and sex of badgers in the captures dataset</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>)){
  <span class="kw">if</span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>]<span class="kw">%in%</span><span class="no">indivdat</span>$<span class="no">tattoo</span>){
    <span class="no">captures</span>$<span class="no">sex</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">indivdat</span>$<span class="no">sex</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])])
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>[<span class="no">i</span>],<span class="fl">7</span>,<span class="fl">10</span>) <span class="kw">==</span> <span class="no">indivdat</span>$<span class="no">year_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])] <span class="kw">&amp;</span> (<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])]) <span class="kw">==</span> <span class="fl">FALSE</span>)<span class="kw">&amp;</span><span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])] <span class="kw">==</span> <span class="st">"CUB"</span>){
      <span class="no">captures</span>$<span class="no">age</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="st">"CUB"</span>
    }
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>[<span class="no">i</span>],<span class="fl">7</span>,<span class="fl">10</span>) <span class="kw">==</span> <span class="no">indivdat</span>$<span class="no">year_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])]<span class="kw">&amp;</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])]) <span class="kw">==</span> <span class="fl">TRUE</span>)){
      <span class="no">captures</span>$<span class="no">age</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
    }
  }
}

<span class="co"># Convert sex as a factor</span>
<span class="no">captures</span>$<span class="no">sex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">captures</span>$<span class="no">sex</span>)

<span class="co"># Add a date column in correct format</span>
<span class="no">captures</span>$<span class="no">date2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>,<span class="fl">7</span>,<span class="fl">10</span>),<span class="st">"-"</span>,<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>,<span class="fl">4</span>,<span class="fl">5</span>),<span class="st">"-"</span>,<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>,<span class="fl">1</span>,<span class="fl">2</span>)))

<span class="co"># Add year, month and day columns</span>
<span class="no">captures</span>$<span class="no">year</span> <span class="kw">&lt;-</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(<span class="no">captures</span>$<span class="no">date2</span>)
<span class="no">captures</span>$<span class="no">month</span> <span class="kw">&lt;-</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(<span class="no">captures</span>$<span class="no">date2</span>)
<span class="no">captures</span>$<span class="no">day</span> <span class="kw">&lt;-</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/day.html">day</a></span>(<span class="no">captures</span>$<span class="no">date2</span>)

<span class="co"># Create a year of study column</span>
<span class="no">captures</span>$<span class="no">year_of_study</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>)){
  <span class="kw">if</span>(<span class="no">captures</span>$<span class="no">month</span>[<span class="no">i</span>] <span class="kw">&gt;</span> <span class="fl">1</span>){
    <span class="no">captures</span>$<span class="no">year_of_study</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">captures</span>$<span class="no">year</span>[<span class="no">i</span>])-<span class="fl">1985</span>
  }
  <span class="kw">if</span>(<span class="no">captures</span>$<span class="no">month</span>[<span class="no">i</span>] <span class="kw">==</span> <span class="fl">1</span>){
    <span class="no">captures</span>$<span class="no">year_of_study</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">captures</span>$<span class="no">year</span>[<span class="no">i</span>])-<span class="fl">1986</span>
  }
}

<span class="co"># subset data to only include 30 years - Feb 1986 to Jan 2016</span>
<span class="no">captures2</span> <span class="kw">&lt;-</span> <span class="no">captures</span>[<span class="no">captures</span>$<span class="no">year_of_study</span><span class="kw">&gt;</span><span class="fl">0</span><span class="kw">&amp;</span><span class="no">captures</span>$<span class="no">year_of_study</span><span class="kw">&lt;</span><span class="fl">31</span>,]

<span class="co"># Create a dataframe in the correct format for CMRnet</span>
<span class="no">captures3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">captures2</span>$<span class="no">tattoo</span>,<span class="no">captures2</span>$<span class="no">socg</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures2</span>)),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures2</span>)),<span class="no">captures2</span>$<span class="no">date2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">captures3</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>,<span class="st">"loc"</span>,<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"date"</span>)

<span class="co"># Assign fake coordinates to locations using there factor ids as we are not going to make use of true geographic coordinates</span>
<span class="no">captures3</span>$<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">captures3</span>$<span class="no">loc</span>))
<span class="no">captures3</span>$<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">captures3</span>$<span class="no">loc</span>))

<span class="co">#Add sex as a layer column</span>
<span class="no">captures3</span>$<span class="no">layer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">captures2</span>$<span class="no">sex</span>)</pre></body></html></div>
<hr>
</div>
<div id="create-multiplex-movement-networks" class="section level4">
<h4 class="hasAnchor">
<a href="#create-multiplex-movement-networks" class="anchor"></a>Create multiplex movement networks</h4>
<p>First we define the parameters we are going to use to generate the networks. For the movement networks we are going to use two year (24 month) network windows and allow an interaction window of 365 days (~one year). By setting <code>nextonly=TRUE</code> we ensure that only direct (recorded) movements between groups are recorded as edges in the network and by setting <code>index=FALSE</code> we set edge weights in the network layers to be counts of the number of movements made.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">
<span class="co"># Define parameters for first time period</span>
<span class="no">mindate</span><span class="kw">&lt;-</span><span class="st">"2006-02-01"</span>
<span class="no">maxdate</span><span class="kw">&lt;-</span><span class="st">"2016-02-01"</span>
<span class="no">intwindow</span><span class="kw">&lt;-</span><span class="fl">365</span>
<span class="no">netwindow</span><span class="kw">&lt;-</span><span class="fl">24</span>
<span class="no">overlap</span><span class="kw">&lt;-</span><span class="fl">0</span>
<span class="no">spacewindow</span><span class="kw">&lt;-</span><span class="fl">0</span>

<span class="co"># Generate Multiplex movement networks</span>
<span class="no">mmd</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/MultiMoveNetCreate.html">MultiMoveNetCreate</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">captures3</span>,
    <span class="kw">intwindow</span> <span class="kw">=</span> <span class="no">intwindow</span>,
    <span class="kw">mindate</span> <span class="kw">=</span> <span class="no">mindate</span>,
    <span class="kw">maxdate</span> <span class="kw">=</span> <span class="no">maxdate</span>,
    <span class="kw">netwindow</span> <span class="kw">=</span> <span class="no">netwindow</span>,
    <span class="kw">overlap</span> <span class="kw">=</span> <span class="no">overlap</span>,
    <span class="kw">nextonly</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
    <span class="kw">index</span><span class="kw">=</span><span class="fl">FALSE</span>
  )
<span class="co">#&gt; [1] "End of final network window aligns with end of study"</span></pre></body></html></div>
<hr>
</div>
<div id="plotting-networks" class="section level4">
<h4 class="hasAnchor">
<a href="#plotting-networks" class="anchor"></a>Plotting networks</h4>
<p>The functionality of <strong>CMRnet</strong> then allows us to convert the output to a list of <strong>igraph</strong> network objects for use in further analyses or plotting</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># create igraph objects</span>
<span class="no">nets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/cmr_igraph.html">cmr_igraph</a></span>(<span class="no">mmd</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"multiplex"</span>)</pre></body></html></div>
<p><strong>CMRnet</strong> includes basic plotting of multiplex movement networks. Plotting multiplex networks is challenging and more sophisticated approaches might require the user to adapt the code presented here or use alternative software such as <a href="http://muxviz.net">MuxViz</a>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># exploratory plots of multiplex movement networks</span>
<span class="fu"><a href="../reference/cmrMultiplexPlot.html">cmrMultiplexPlot</a></span>(<span class="kw">nets</span><span class="kw">=</span><span class="no">nets</span>,
                 <span class="kw">fixed_locs</span><span class="kw">=</span><span class="fl">TRUE</span>,
                 <span class="kw">dynamic</span><span class="kw">=</span><span class="fl">FALSE</span>,
                 <span class="kw">rows</span><span class="kw">=</span><span class="fl">2</span>,
                 <span class="kw">layer_colours</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dodger blue"</span>,<span class="st">"firebrick"</span>))</pre></body></html></div>
<p><img src="CaseStudyTwo_files/figure-html/plot_networks-1.png" width="624" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="calculate-network-measures" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-network-measures" class="anchor"></a>Calculate network measures</h4>
<p>We can also use the <strong>igraph</strong> objects saved to calculate various network measures. We provide a simple example here by calculating the betweenness centrality separately for the different layers, both in the overall network and for each network window independently.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">
<span class="co"># calculate betweenness centrality for each layer in the overall network</span>
<span class="no">betweenness_ovr</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nets</span><span class="kw">[[</span><span class="fl">2</span>]],<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span>)

<span class="co"># calculate betweenness centrality separately for each network layer in each network window (you could do this in a loop or using apply if you preferred)</span>
<span class="no">betweenness1</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nets</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">[[</span><span class="fl">1</span>]],<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span>)
<span class="no">betweenness2</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nets</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">[[</span><span class="fl">2</span>]],<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span>)
<span class="no">betweenness3</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nets</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">[[</span><span class="fl">3</span>]],<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span>)
<span class="no">betweenness4</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nets</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">[[</span><span class="fl">4</span>]],<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span>)
<span class="no">betweenness5</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">nets</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">[[</span><span class="fl">5</span>]],<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span>)</pre></body></html></div>
<p>These calculations can then be used to go on and test hypotheses or conduct exploratory analyses on the networks generated. For example, here we look at the association between betweenness centrality in the female layer and male layer of the overall network. We use a 1:1 line to show that badger setts or groups tend to have higher betweenness in the male rather than female layer of the movement network. There is perhaps some indication as well that setts or groups that have high betweenness in one layer tend also to have higher betweenness in the other layer, although clearly this would require an appropriate analysis to test formally.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">
<span class="co"># test relationship in betweenness centrality between layers in the overall network</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">3</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">betweenness_ovr</span><span class="kw">[[</span><span class="fl">1</span>]],<span class="no">betweenness_ovr</span><span class="kw">[[</span><span class="fl">2</span>]],
     <span class="kw">xlab</span><span class="kw">=</span><span class="st">"Betweenness in female movement layer"</span>,
     <span class="kw">ylab</span><span class="kw">=</span><span class="st">"Betweenness in\nmale movement layer"</span>,
     <span class="kw">pch</span><span class="kw">=</span><span class="fl">16</span>,
     <span class="kw">cex</span><span class="kw">=</span><span class="fl">1.5</span>,
     <span class="kw">col</span><span class="kw">=</span><span class="st">"dark blue"</span>,
     <span class="kw">cex.axis</span><span class="kw">=</span><span class="fl">1.3</span>,
     <span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.1</span>,
     <span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">350</span>),
     <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">350</span>),
     <span class="kw">las</span><span class="kw">=</span><span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">200</span>,<span class="fl">500</span>,<span class="fl">1</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">200</span>,<span class="fl">500</span>,<span class="fl">1</span>),<span class="kw">lty</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<p><img src="CaseStudyTwo_files/figure-html/plot_betweenness-1.png" width="576" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="references" class="section level4">
<h4 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h4>
<ul>
<li>Delahay, R. J., Walker, N., Smith, G. S., Wilkinson, D., Clifton-Hadley, R. S., Cheeseman, C. L., … Chambers, M. A. (2013). Long-term temporal trends and estimated transmission rates for Mycobacterium bovis infection in an undisturbed high-density badger (Meles meles) population. Epidemiology and Infection, 141(07), 1445–1456.</li>
<li>McDonald, J. L., Robertson, A., &amp; Silk, M. J. (2018). Wildlife disease ecology from the individual to the population: Insights from a long-term study of a naturally infected European badger population. Journal of Animal Ecology, 87(1). <a href="doi:10.1111/1365-2656.12743" class="uri">doi:10.1111/1365-2656.12743</a>
</li>
<li>Weber, N., Carter, S. P., Dall, S. R. X., Delahay, R. J., McDonald, J. L., Bearhop, S., &amp; McDonald, R. A. (2013). Badger social networks correlate with tuberculosis infection. Current Biology, 23(20), R915–R916.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Silk, Daniel Padfield.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
