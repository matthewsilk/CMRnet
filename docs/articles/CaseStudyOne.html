<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case Study One: Social behaviour during a badger lifetime • CMRnet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Case Study One: Social behaviour during a badger lifetime">
<meta property="og:description" content="CMRnet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CMRnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CMRnet.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Information</li>
    <li>
      <a href="../articles/CMRnet_information.html">Detailed information on using CMRnet</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Case studies</li>
    <li>
      <a href="../articles/CaseStudyOne.html">Case Study One: Social behaviour during a badger lifetime</a>
    </li>
    <li>
      <a href="../articles/CaseStudyTwo.html">Case Study Two: Example of a multiplex movement network</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Case Study One: Social behaviour during a badger lifetime</h1>
                        <h4 class="author">Matthew Silk</h4>
            
            <h4 class="date">2020-07-03</h4>
      
      
      <div class="hidden name"><code>CaseStudyOne.Rmd</code></div>

    </div>

    
    
<div id="example-of-using-cmrnet-to-generate-movement-networks-of-european-badgers-for-use-in-analyses-linking-deaths-caused-by-collisions-with-cars-to-the-position-of-groups-within-movement-networks" class="section level4">
<h4 class="hasAnchor">
<a href="#example-of-using-cmrnet-to-generate-movement-networks-of-european-badgers-for-use-in-analyses-linking-deaths-caused-by-collisions-with-cars-to-the-position-of-groups-within-movement-networks" class="anchor"></a>Example of using CMRnet to generate movement networks of European badgers for use in analyses linking deaths caused by collisions with cars to the position of groups within movement networks</h4>
<hr>
</div>
<div id="background" class="section level4">
<h4 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h4>
<p>This case study is based on a long-term CMR dataset from a high-density population of European badgers in the United Kingdom (Delahay et al., 2013; McDonald, Robertson, &amp; Silk, 2018). Badgers in medium to high-density populations live in territorial social groups centred on a main sett (refuge/burrow system), resulting in modular social networks in which they interact frequently with other group members but much less often with individuals from other groups (Weber et al., 2013). The study population is trap-sampled four times per year (in May-June, July-August, September-October and December-January) using baited cage traps deployed at all know active sett locations (see McDonald et al., 2018 for more detail). Badgers give birth in late-winter (the date of birth of all cubs is assumed to be 1st February) and no trapping takes place while females have dependent cubs.</p>
<p>Here we use the co-capture network construction features of CMRnet to examine how the social network position of badgers changes during their lifetime. Individuals that are more strongly connected to those in other groups will be more central to the population network. We expect that the centrality of individuals in social networks peaks when levels of reproductive behaviour as this drives many between-group movements and interactions. Badgers in our study population demonstrate body mass and immune senescence, and so we would expect network centrality to peak in early adulthood, subsequent to maturity but prior to condition beginning to decline. We would also predict that this peak will be higher in males than females, due to differences in social and spatial behaviour.</p>
<hr>
</div>
<div id="setup-and-data-manipulation" class="section level4">
<h4 class="hasAnchor">
<a href="#setup-and-data-manipulation" class="anchor"></a>Setup and data manipulation</h4>
<p>First we set up our environment.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lubridate</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">CMRnet</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">glmmTMB</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">igraph</span>)</pre></body></html></div>
<p>The data we use here is not documented in the package, but can be accessed to recreate this analyses by using <code>CMRnet:::capturesData</code> and <code>CMRnet:::individualData</code>. The data is on …</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># look at dimensions of data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">captures</span>)
<span class="co">#&gt; 'data.frame':    14461 obs. of  6 variables:</span>
<span class="co">#&gt;  $ tattoo     : chr  "Y001" "Y002" "G020" "B031" ...</span>
<span class="co">#&gt;  $ date       : chr  "10/06/1981" "10/06/1981" "11/06/1981" "12/06/1981" ...</span>
<span class="co">#&gt;  $ socg       : chr  "WEST" "SEPTIC TANK" "SEPTIC TANK" "SEPTIC TANK" ...</span>
<span class="co">#&gt;  $ sett       : chr  "WEST" "SEPTIC TANK" "SEPTIC TANK" "SEPTIC TANK" ...</span>
<span class="co">#&gt;  $ CaptureYear: int  1981 1981 1981 1981 1981 1981 1981 1981 1981 1981 ...</span>
<span class="co">#&gt;  $ where      : chr  "SETT" "SETT" "SETT" "SETT" ...</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">indivdat</span>)
<span class="co">#&gt; 'data.frame':    2975 obs. of  4 variables:</span>
<span class="co">#&gt;  $ tattoo : chr  "001A" "001B" "001E" "001F" ...</span>
<span class="co">#&gt;  $ age_fc : chr  "CUB" "ADULT" "CUB" "ADULT" ...</span>
<span class="co">#&gt;  $ year_fc: int  2014 2006 2013 2010 2003 2012 2011 2009 2008 2004 ...</span>
<span class="co">#&gt;  $ sex    : chr  "FEMALE" "MALE" "FEMALE" "MALE" ...</span></pre></body></html></div>
<p>We then do some data manipulation to fill in data on the age and sex of badgers in the captures data set. We also wrangle the date formats and create a dataframe in the format needed for <strong>CMRnet</strong>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># create empty columns for sex and age</span>
<span class="no">captures</span>$<span class="no">sex</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>))
<span class="no">captures</span>$<span class="no">age</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"ADULT"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>))

<span class="co"># fill in data on the age and sex of badgers in the captures dataset</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>)){
  <span class="kw">if</span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>]<span class="kw">%in%</span><span class="no">indivdat</span>$<span class="no">tattoo</span>){
    <span class="no">captures</span>$<span class="no">sex</span>[<span class="no">i</span>]<span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">indivdat</span>$<span class="no">sex</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])])
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>[<span class="no">i</span>],<span class="fl">7</span>,<span class="fl">10</span>)<span class="kw">==</span><span class="no">indivdat</span>$<span class="no">year_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])]<span class="kw">&amp;</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])])<span class="kw">==</span><span class="fl">FALSE</span>)<span class="kw">&amp;</span><span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])]<span class="kw">==</span><span class="st">"CUB"</span>){
      <span class="no">captures</span>$<span class="no">age</span>[<span class="no">i</span>]<span class="kw">&lt;-</span><span class="st">"CUB"</span>
    }
    <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>[<span class="no">i</span>],<span class="fl">7</span>,<span class="fl">10</span>)<span class="kw">==</span><span class="no">indivdat</span>$<span class="no">year_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])]<span class="kw">&amp;</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures</span>$<span class="no">tattoo</span>[<span class="no">i</span>])])<span class="kw">==</span><span class="fl">TRUE</span>)){
      <span class="no">captures</span>$<span class="no">age</span>[<span class="no">i</span>]<span class="kw">&lt;-</span><span class="fl">NA</span>
    }
  }
}

<span class="co"># Convert sex to a factor</span>
<span class="no">captures</span>$<span class="no">sex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">captures</span>$<span class="no">sex</span>)

<span class="co"># Add a date column in correct format</span>
<span class="no">captures</span>$<span class="no">date2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>,<span class="fl">7</span>,<span class="fl">10</span>),<span class="st">"-"</span>,<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>,<span class="fl">4</span>,<span class="fl">5</span>),<span class="st">"-"</span>,<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">captures</span>$<span class="no">date</span>,<span class="fl">1</span>,<span class="fl">2</span>)))

<span class="co"># Add year, month and day columns</span>
<span class="no">captures</span>$<span class="no">year</span> <span class="kw">&lt;-</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(<span class="no">captures</span>$<span class="no">date2</span>)
<span class="no">captures</span>$<span class="no">month</span> <span class="kw">&lt;-</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(<span class="no">captures</span>$<span class="no">date2</span>)
<span class="no">captures</span>$<span class="no">day</span> <span class="kw">&lt;-</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/day.html">day</a></span>(<span class="no">captures</span>$<span class="no">date2</span>)

<span class="co"># Create a year of study column</span>
<span class="no">captures</span>$<span class="no">year_of_study</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures</span>)){
  <span class="kw">if</span>(<span class="no">captures</span>$<span class="no">month</span>[<span class="no">i</span>]<span class="kw">&gt;</span><span class="fl">1</span>){
    <span class="no">captures</span>$<span class="no">year_of_study</span>[<span class="no">i</span>]<span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">captures</span>$<span class="no">year</span>[<span class="no">i</span>])-<span class="fl">1985</span>
  }
  <span class="kw">if</span>(<span class="no">captures</span>$<span class="no">month</span>[<span class="no">i</span>]<span class="kw">==</span><span class="fl">1</span>){
    <span class="no">captures</span>$<span class="no">year_of_study</span>[<span class="no">i</span>]<span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">captures</span>$<span class="no">year</span>[<span class="no">i</span>])-<span class="fl">1986</span>
  }
}

<span class="co"># Subset data to only include 30 years - Feb 1986 to Jan 2016</span>
<span class="no">captures2</span> <span class="kw">&lt;-</span> <span class="no">captures</span>[<span class="no">captures</span>$<span class="no">year_of_study</span><span class="kw">&gt;</span><span class="fl">0</span><span class="kw">&amp;</span><span class="no">captures</span>$<span class="no">year_of_study</span><span class="kw">&lt;</span><span class="fl">31</span>,]

<span class="co"># Create a dataframe in the correct format for CMRnet</span>
<span class="no">captures3</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">captures2</span>$<span class="no">tattoo</span>,<span class="no">captures2</span>$<span class="no">socg</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures2</span>)),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">captures2</span>)),<span class="no">captures2</span>$<span class="no">date2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">captures3</span>)<span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>,<span class="st">"loc"</span>,<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"date"</span>)

<span class="co"># Assign fake coordinates to locations using there factor ids as they are not used anyway in this analysis</span>
<span class="no">captures3</span>$<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">captures3</span>$<span class="no">loc</span>))
<span class="no">captures3</span>$<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">captures3</span>$<span class="no">loc</span>))

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">captures3</span>)
<span class="co">#&gt; 'data.frame':    13241 obs. of  5 variables:</span>
<span class="co">#&gt;  $ id  : chr  "N049" "F011" "F013" "F014" ...</span>
<span class="co">#&gt;  $ loc : chr  "WEST" "COLLIERS WOOD" "JUNCTION" "JUNCTION" ...</span>
<span class="co">#&gt;  $ x   : num  38 12 22 22 12 30 30 5 43 1 ...</span>
<span class="co">#&gt;  $ y   : num  38 12 22 22 12 30 30 5 43 1 ...</span>
<span class="co">#&gt;  $ date: Date, format: "1986-02-10" "1986-02-17" ...</span></pre></body></html></div>
<hr>
</div>
<div id="create-social-networks" class="section level4">
<h4 class="hasAnchor">
<a href="#create-social-networks" class="anchor"></a>Create social networks</h4>
<p>We now create the social networks using <code>DynamicNetCreate</code> because we have data on co-capture of badgers across the thirty year period.</p>
<p>-We choose a 12 month network window that runfs from February-January to correspond with badger life-history (cubs are born in later winter) and trapping strategy. -We choose a 30 day interaction window. As trapping is (approximately) quarterly this ensures that all individuals captured in the same trapping event at the same location are considered to be co-captured. -We set the space window to zero so that individuals have to be captured at the same location to be co-captured.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">
<span class="co">#Define parameters for first time period</span>
<span class="no">mindate</span><span class="kw">&lt;-</span><span class="st">"1986-02-01"</span>
<span class="no">maxdate</span><span class="kw">&lt;-</span><span class="st">"1987-02-01"</span>
<span class="no">intwindow</span><span class="kw">&lt;-</span><span class="fl">30</span>
<span class="no">netwindow</span><span class="kw">&lt;-</span><span class="fl">12</span>
<span class="no">overlap</span><span class="kw">&lt;-</span><span class="fl">0</span>
<span class="no">spacewindow</span><span class="kw">&lt;-</span><span class="fl">0</span>

<span class="co">#Create network for first time period</span>
<span class="no">netdat1</span><span class="kw">&lt;-</span><span class="fu"><a href="../reference/DynamicNetCreate.html">DynamicNetCreate</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">captures3</span>,
                          <span class="kw">intwindow</span><span class="kw">=</span><span class="no">intwindow</span>,
                          <span class="kw">mindate</span><span class="kw">=</span><span class="no">mindate</span>,
                          <span class="kw">maxdate</span><span class="kw">=</span><span class="no">maxdate</span>,
                          <span class="kw">netwindow</span><span class="kw">=</span><span class="no">netwindow</span>,
                          <span class="kw">overlap</span><span class="kw">=</span><span class="no">overlap</span>,
                          <span class="kw">spacewindow</span><span class="kw">=</span><span class="no">spacewindow</span>)

<span class="co">#Create lists to store network data</span>
<span class="no">netdats</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">netdats</span><span class="kw">[[</span><span class="fl">1</span>]]<span class="kw">&lt;-</span><span class="no">netdat1</span>

<span class="co">#Loop to create networks for remaining time periods</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1987</span>,<span class="fl">2015</span>,<span class="fl">1</span>)){
  <span class="no">mindate</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">i</span>,<span class="st">"-02-01"</span>)
  <span class="no">maxdate</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">i</span>+<span class="fl">1</span>,<span class="st">"-02-01"</span>)
  <span class="no">intwindow</span><span class="kw">&lt;-</span><span class="fl">30</span>
  <span class="no">netwindow</span><span class="kw">&lt;-</span><span class="fl">12</span>
  <span class="no">overlap</span><span class="kw">&lt;-</span><span class="fl">0</span>
  <span class="no">spacewindow</span><span class="kw">&lt;-</span><span class="fl">0</span>
  <span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]<span class="kw">&lt;-</span><span class="fu"><a href="../reference/DynamicNetCreate.html">DynamicNetCreate</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">captures3</span>,
                                      <span class="kw">intwindow</span><span class="kw">=</span><span class="no">intwindow</span>,
                                      <span class="kw">mindate</span><span class="kw">=</span><span class="no">mindate</span>,
                                      <span class="kw">maxdate</span><span class="kw">=</span><span class="no">maxdate</span>,
                                      <span class="kw">netwindow</span><span class="kw">=</span><span class="no">netwindow</span>,
                                      <span class="kw">overlap</span><span class="kw">=</span><span class="no">overlap</span>,
                                      <span class="kw">spacewindow</span><span class="kw">=</span><span class="no">spacewindow</span>)

}</pre></body></html></div>
</div>
<div id="calculate-network-metrics" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-network-metrics" class="anchor"></a>Calculate network metrics</h4>
<p>We then calculate network metrics on the observed dataset. The networks calculated are:</p>
<ul>
<li>Degree</li>
<li>Eigenvector Centrality</li>
<li>Betweenness</li>
<li>PageRank Centrality</li>
</ul>
<p>In this analysis we use (unweighted) Degree.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">
<span class="co"># Create list to store results</span>
<span class="no">t_net_mets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()

<span class="co"># Calculate network metrics to use</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">netdats</span>)){

  <span class="no">inet</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph.adjacency</a></span>(<span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>]]<span class="kw">[[</span><span class="fl">2</span>]][,,<span class="fl">1</span>],<span class="kw">weighted</span><span class="kw">=</span><span class="kw">NULL</span>,<span class="kw">mode</span><span class="kw">=</span><span class="st">"undirected"</span>)
  <span class="no">ind</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/vertex_attr.html">vertex_attr</a></span>(<span class="no">inet</span>)$<span class="no">name</span>
  <span class="no">tp</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/vertex_attr.html">vertex_attr</a></span>(<span class="no">inet</span>)$<span class="no">name</span>))

  <span class="no">t_net_mets</span><span class="kw">[[</span><span class="no">i</span>]]<span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">ind</span>,<span class="no">tp</span>)
  <span class="no">t_net_mets</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">deg</span><span class="kw">&lt;-</span><span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span>(<span class="no">inet</span>)
  <span class="no">t_net_mets</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">eig</span><span class="kw">&lt;-</span><span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/eigen_centrality.html">eigen_centrality</a></span>(<span class="no">inet</span>)$<span class="no">vector</span>
  <span class="no">t_net_mets</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">bet</span><span class="kw">&lt;-</span><span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span>(<span class="no">inet</span>)
  <span class="no">t_net_mets</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">pr</span><span class="kw">&lt;-</span><span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/page_rank.html">page.rank</a></span>(<span class="no">inet</span>)$<span class="no">vector</span>

}

<span class="co"># Collate results</span>
<span class="no">net_mets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, <span class="no">t_net_mets</span>)

<span class="co"># Create overall results dataframe</span>
<span class="co"># Add info on age, sex and group id</span>
<span class="no">net_mets</span>$<span class="no">group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>))
<span class="no">net_mets</span>$<span class="no">sex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>))
<span class="no">net_mets</span>$<span class="no">age</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>)){
  <span class="no">net_mets</span>$<span class="no">sex</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures2</span>$<span class="no">sex</span>[<span class="no">captures2</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])]))
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])]) <span class="kw">&gt;</span> <span class="fl">0</span>){
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])]) <span class="kw">==</span> <span class="fl">FALSE</span> <span class="kw">&amp;</span> <span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])] <span class="kw">==</span> <span class="st">"CUB"</span>){
    <span class="no">net_mets</span>$<span class="no">age</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">net_mets</span>$<span class="no">tp</span>[<span class="no">i</span>]-(<span class="no">indivdat</span>$<span class="no">year_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])]-<span class="fl">1985</span>)
  }
  }
  <span class="no">t.gr</span> <span class="kw">&lt;-</span> <span class="no">captures3</span>[<span class="no">captures3</span>$<span class="no">id</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>]),]
  <span class="no">t.gr2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">t.gr</span>$<span class="no">loc</span>)
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="no">t.gr2</span>))) <span class="kw">==</span> <span class="fl">1</span>){
   <span class="no">net_mets</span>$<span class="no">group</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="no">t.gr2</span>))
  }
}

<span class="co">#Remove captures with NAs for any of these additional variables</span>
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets</span>[!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">net_mets</span>$<span class="no">age</span>),]
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">net_mets2</span>$<span class="no">sex</span>),]
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">net_mets2</span>$<span class="no">group</span>),]

<span class="co">#And remove individuals with erroneous ages below 0 </span>
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[<span class="no">net_mets2</span>$<span class="no">age</span><span class="kw">&gt;</span>-<span class="fl">1</span>,]

<span class="co">#Create age squared variable</span>
<span class="no">net_mets2</span>$<span class="no">agesq</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>$<span class="no">age</span>^<span class="fl">2</span>

<span class="co">#Remove all individuals only recorded once from the analysis</span>
<span class="no">net_mets3</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[<span class="no">net_mets2</span>$<span class="no">ind</span><span class="kw">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>)<span class="kw">&gt;</span><span class="fl">1</span>)),]

<span class="co">#Create binary measure of whether individuals have a betweenness or not</span>
<span class="no">net_mets3</span>$<span class="no">betbin</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(<span class="no">net_mets3</span>$<span class="no">bet</span>)</pre></body></html></div>
</div>
<div id="model-the-observed-dataset" class="section level4">
<h4 class="hasAnchor">
<a href="#model-the-observed-dataset" class="anchor"></a>Model the observed dataset</h4>
<p>We now conduct the statistical modelling of the observed dataset. This is done using glmmTMB. We first fit a generalised linear mixed effects model using a negative binomial error distribution. Degree is the response variable. We have fixed effects of sex, age and age squared, and consider interactions between sex and age and sex and age-squared. We have random effects of individual, capture group and network window. We confirm that parameters estimates from a linear mixed-effects model after a log-normal transformation are very similar, and so use these in subsequent analyses (due to computational limitations when using permutation-based methods).</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># first model</span>
<span class="no">mod_deg2</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span>(<span class="no">deg</span>~<span class="no">sex</span>*<span class="no">age</span>+<span class="no">sex</span>*<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="no">age</span>^<span class="fl">2</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">ind</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">group</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">tp</span>),
                  <span class="kw">data</span><span class="kw">=</span><span class="no">net_mets3</span>[<span class="no">net_mets3</span>$<span class="no">age</span><span class="kw">&lt;</span><span class="fl">11</span>,],
                  <span class="kw">family</span><span class="kw">=</span><span class="no">nbinom2</span>)

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2</span>)
<span class="co">#&gt;  Family: nbinom2  ( log )</span>
<span class="co">#&gt; Formula:          deg ~ sex * age + sex * I(age^2) + (1 | ind) + (1 | group) +  </span>
<span class="co">#&gt;     (1 | tp)</span>
<span class="co">#&gt; Data: net_mets3[net_mets3$age &lt; 11, ]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span>
<span class="co">#&gt;  34586.3  34651.9 -17283.1  34566.3     5223 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Random effects:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Conditional model:</span>
<span class="co">#&gt;  Groups Name        Variance Std.Dev.</span>
<span class="co">#&gt;  ind    (Intercept) 0.07782  0.2790  </span>
<span class="co">#&gt;  group  (Intercept) 0.10059  0.3172  </span>
<span class="co">#&gt;  tp     (Intercept) 0.11862  0.3444  </span>
<span class="co">#&gt; Number of obs: 5233, groups:  ind, 1376; group, 40; tp, 30</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Overdispersion parameter for nbinom2 family ():  3.8 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Conditional model:</span>
<span class="co">#&gt;                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)       2.3271715  0.0849402  27.398  &lt; 2e-16 ***</span>
<span class="co">#&gt; sexMALE           0.0949437  0.0330385   2.874  0.00406 ** </span>
<span class="co">#&gt; age              -0.1379655  0.0137824 -10.010  &lt; 2e-16 ***</span>
<span class="co">#&gt; I(age^2)          0.0102786  0.0017098   6.012 1.84e-09 ***</span>
<span class="co">#&gt; sexMALE:age      -0.0220759  0.0221562  -0.996  0.31907    </span>
<span class="co">#&gt; sexMALE:I(age^2)  0.0005678  0.0029083   0.195  0.84520    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># second model</span>
<span class="no">mod_deg2alt</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">deg</span>+<span class="fl">1</span>)~<span class="no">sex</span>*<span class="no">age</span>+<span class="no">sex</span>*<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="no">age</span>^<span class="fl">2</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">ind</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">group</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">tp</span>),
                     <span class="kw">data</span><span class="kw">=</span><span class="no">net_mets3</span>[<span class="no">net_mets3</span>$<span class="no">age</span><span class="kw">&lt;</span><span class="fl">11</span>,],
                     <span class="kw">family</span><span class="kw">=</span><span class="no">gaussian</span>)

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)
<span class="co">#&gt;  Family: gaussian  ( identity )</span>
<span class="co">#&gt; Formula:          log(deg + 1) ~ sex * age + sex * I(age^2) + (1 | ind) + (1 |  </span>
<span class="co">#&gt;     group) + (1 | tp)</span>
<span class="co">#&gt; Data: net_mets3[net_mets3$age &lt; 11, ]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span>
<span class="co">#&gt;  10509.3  10574.9  -5244.7  10489.3     5223 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Random effects:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Conditional model:</span>
<span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span>
<span class="co">#&gt;  ind      (Intercept) 0.07843  0.2800  </span>
<span class="co">#&gt;  group    (Intercept) 0.08595  0.2932  </span>
<span class="co">#&gt;  tp       (Intercept) 0.09293  0.3048  </span>
<span class="co">#&gt;  Residual             0.35848  0.5987  </span>
<span class="co">#&gt; Number of obs: 5233, groups:  ind, 1376; group, 40; tp, 30</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Dispersion estimate for gaussian family (sigma^2): 0.358 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Conditional model:</span>
<span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)       2.277218   0.077103  29.535  &lt; 2e-16 ***</span>
<span class="co">#&gt; sexMALE           0.104395   0.033050   3.159  0.00158 ** </span>
<span class="co">#&gt; age              -0.131065   0.013589  -9.645  &lt; 2e-16 ***</span>
<span class="co">#&gt; I(age^2)          0.010051   0.001664   6.041 1.53e-09 ***</span>
<span class="co">#&gt; sexMALE:age      -0.037164   0.021645  -1.717  0.08599 .  </span>
<span class="co">#&gt; sexMALE:I(age^2)  0.001649   0.002810   0.587  0.55726    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></body></html></div>
</div>
<div id="create-permuted-datasets" class="section level4">
<h4 class="hasAnchor">
<a href="#create-permuted-datasets" class="anchor"></a>Create permuted datasets</h4>
<p>We now create permuted datasets. These are randomisations of the dataset to see what a random network would look like.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">
<span class="co"># First we create a list of matrices to use to restrict the swaps conducted</span>

<span class="no">restricts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()

<span class="co">#Loop to create networks for remaining time periods</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1986</span>,<span class="fl">2015</span>,<span class="fl">1</span>)){

  <span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">0</span>,<span class="kw">dim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]<span class="kw">[[</span><span class="fl">2</span>]]),<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]<span class="kw">[[</span><span class="fl">2</span>]]),<span class="fl">1</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]<span class="kw">[[</span><span class="fl">2</span>]])
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]<span class="kw">[[</span><span class="fl">2</span>]])

  <span class="no">mindate</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">i</span>,<span class="st">"-02-01"</span>)
  <span class="no">maxdate</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">i</span>+<span class="fl">1</span>,<span class="st">"-02-01"</span>)
  <span class="no">D</span> <span class="kw">&lt;-</span> <span class="no">captures3</span>

  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">D</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>,<span class="st">"loc"</span>,<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"date"</span>)
  <span class="no">Jdays</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">julian</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">D</span>$<span class="no">date</span>),<span class="kw">origin</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"1970-01-01"</span>))
  <span class="no">D</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">D</span>,<span class="no">Jdays</span>)
  <span class="no">D</span> <span class="kw">&lt;-</span> <span class="no">D</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">D</span>$<span class="no">Jdays</span>, <span class="no">D</span>$<span class="no">loc</span>,<span class="no">D</span>$<span class="no">id</span>),]
  <span class="no">D</span>$<span class="no">id</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">D</span>$<span class="no">id</span>)
  <span class="no">D</span>$<span class="no">loc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">D</span>$<span class="no">loc</span>)
  <span class="no">D</span>$<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">D</span>$<span class="no">x</span>)
  <span class="no">D</span>$<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">D</span>$<span class="no">y</span>)
  <span class="no">start</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">julian</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">mindate</span>),<span class="kw">origin</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"1970-01-01"</span>))
  <span class="no">end</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">julian</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">maxdate</span>),<span class="kw">origin</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"1970-01-01"</span>))
  <span class="no">D2</span> <span class="kw">&lt;-</span> <span class="no">D</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">D</span>$<span class="no">Jdays</span><span class="kw">&gt;=</span><span class="no">start</span><span class="kw">&amp;</span><span class="no">D</span>$<span class="no">Jdays</span><span class="kw">&lt;</span><span class="no">end</span>),]

  <span class="no">tinds</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]]<span class="kw">[[</span><span class="fl">2</span>]])
  <span class="kw">for</span>(<span class="no">ii</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">tinds</span>)){
    <span class="no">tlocs</span> <span class="kw">&lt;-</span> <span class="no">D2</span>[<span class="no">D2</span>$<span class="no">id</span><span class="kw">==</span><span class="no">tinds</span>[<span class="no">ii</span>],]$<span class="no">loc</span>
    <span class="no">tinds2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">D2</span>[<span class="no">D2</span>$<span class="no">loc</span><span class="kw">%in%</span><span class="no">tlocs</span>,]$<span class="no">id</span>)
    <span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]][<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]])<span class="kw">%in%</span><span class="no">tinds2</span>,<span class="no">tinds</span>[<span class="no">ii</span>],<span class="fl">1</span>]<span class="kw">&lt;-</span><span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]][<span class="no">tinds</span>[<span class="no">ii</span>],<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>-<span class="fl">1985</span>]])<span class="kw">%in%</span><span class="no">tinds2</span>,<span class="fl">1</span>]<span class="kw">&lt;-</span><span class="fl">1</span>
  }

}

<span class="no">permuted_nets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">netdats</span>)){
  <span class="no">permuted_nets</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/cmrRestrictedNodeswap.html">cmrRestrictedNodeswap</a></span>(<span class="kw">cmrnet</span><span class="kw">=</span><span class="no">netdats</span><span class="kw">[[</span><span class="no">i</span>]],
                                              <span class="kw">restrict</span><span class="kw">=</span><span class="no">restricts</span><span class="kw">[[</span><span class="no">i</span>]],
                                              <span class="kw">n.rand</span><span class="kw">=</span><span class="fl">1000</span>,
                                              <span class="kw">n.burnin</span><span class="kw">=</span><span class="fl">500</span>,
                                              <span class="kw">n.swaps</span><span class="kw">=</span><span class="fl">40</span>,
                                              <span class="kw">multi</span><span class="kw">=</span><span class="fl">FALSE</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">i</span>,<span class="st">"done"</span>))
}</pre></body></html></div>
</div>
<div id="analyse-permuted-datasets" class="section level4">
<h4 class="hasAnchor">
<a href="#analyse-permuted-datasets" class="anchor"></a>Analyse permuted datasets</h4>
<p>We can now rebuild the dataframe analysed and refit models for the permuted datasets.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">
<span class="no">n.rand</span> <span class="kw">&lt;-</span> <span class="fl">1000</span>

<span class="no">fixefs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nr</span><span class="kw">=</span><span class="no">n.rand</span>,<span class="kw">nc</span><span class="kw">=</span><span class="fl">6</span>)
<span class="no">ranefs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nr</span><span class="kw">=</span><span class="no">n.rand</span>,<span class="kw">nc</span><span class="kw">=</span><span class="fl">4</span>)

<span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">n.rand</span>){

<span class="co"># Create list to store results</span>
<span class="no">t_net_mets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()

<span class="co"># Calculate network metrics to use</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">netdats</span>)){

  <span class="no">inet</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html">graph.adjacency</a></span>(<span class="no">permuted_nets</span><span class="kw">[[</span><span class="no">i</span>]]<span class="kw">[[</span><span class="fl">1</span>]][,,<span class="no">j</span>],<span class="kw">weighted</span><span class="kw">=</span><span class="kw">NULL</span>,<span class="kw">mode</span><span class="kw">=</span><span class="st">"undirected"</span>)
  <span class="no">ind</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/vertex_attr.html">vertex_attr</a></span>(<span class="no">inet</span>)$<span class="no">name</span>
  <span class="no">tp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/vertex_attr.html">vertex_attr</a></span>(<span class="no">inet</span>)$<span class="no">name</span>))

  <span class="no">t_net_mets</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">ind</span>,<span class="no">tp</span>)
  <span class="no">t_net_mets</span><span class="kw">[[</span><span class="no">i</span>]]$<span class="no">deg</span> <span class="kw">&lt;-</span> <span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span>(<span class="no">inet</span>)

}

<span class="co"># Collate results</span>
<span class="no">net_mets</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, <span class="no">t_net_mets</span>)

<span class="co"># Create overall results dataframe</span>
<span class="co"># Add info on age, sex and group id</span>
<span class="no">net_mets</span>$<span class="no">group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>))
<span class="no">net_mets</span>$<span class="no">sex</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>))
<span class="no">net_mets</span>$<span class="no">age</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>))

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">net_mets</span>)){
  <span class="no">net_mets</span>$<span class="no">sex</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">captures2</span>$<span class="no">sex</span>[<span class="no">captures2</span>$<span class="no">tattoo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])]))
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])])<span class="kw">&gt;</span><span class="fl">0</span>){
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])])<span class="kw">==</span> <span class="fl">FALSE</span><span class="kw">&amp;</span><span class="no">indivdat</span>$<span class="no">age_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])] <span class="kw">==</span> <span class="st">"CUB"</span>){
    <span class="no">net_mets</span>$<span class="no">age</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">net_mets</span>$<span class="no">tp</span>[<span class="no">i</span>]-(<span class="no">indivdat</span>$<span class="no">year_fc</span>[<span class="no">indivdat</span>$<span class="no">tattoo</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>])]-<span class="fl">1985</span>)
  }
  }
  <span class="no">t.gr</span> <span class="kw">&lt;-</span> <span class="no">captures3</span>[<span class="no">captures3</span>$<span class="no">id</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>[<span class="no">i</span>]),]
  <span class="no">t.gr2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">t.gr</span>$<span class="no">loc</span>)
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="no">t.gr2</span>))) <span class="kw">==</span> <span class="fl">1</span>){
   <span class="no">net_mets</span>$<span class="no">group</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="no">t.gr2</span>))
  }
}

<span class="co"># Remove captures with NAs for any of these additional variables</span>
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets</span>[!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">net_mets</span>$<span class="no">age</span>),]
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">net_mets2</span>$<span class="no">sex</span>),]
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">net_mets2</span>$<span class="no">group</span>),]

<span class="co"># And remove individuals with erroneous ages below 0 </span>
<span class="no">net_mets2</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[<span class="no">net_mets2</span>$<span class="no">age</span><span class="kw">&gt;</span>-<span class="fl">1</span>,]

<span class="co"># Create age squared variable</span>
<span class="no">net_mets2</span>$<span class="no">agesq</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>$<span class="no">age</span>^<span class="fl">2</span>

<span class="co">#Remove all individuals only recorded once from the analysis</span>
<span class="no">net_mets3</span> <span class="kw">&lt;-</span> <span class="no">net_mets2</span>[<span class="no">net_mets2</span>$<span class="no">ind</span><span class="kw">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">net_mets</span>$<span class="no">ind</span>)<span class="kw">&gt;</span><span class="fl">1</span>)),]

<span class="no">tmod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">deg</span>+<span class="fl">1</span>)~<span class="no">sex</span>*<span class="no">age</span>+<span class="no">sex</span>*<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="no">age</span>^<span class="fl">2</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">ind</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">group</span>)+(<span class="fl">1</span><span class="kw">|</span><span class="no">tp</span>),
                <span class="kw">data</span><span class="kw">=</span><span class="no">net_mets3</span>[<span class="no">net_mets3</span>$<span class="no">age</span><span class="kw">&lt;</span><span class="fl">11</span>,],
                <span class="kw">family</span><span class="kw">=</span><span class="no">gaussian</span>)

<span class="no">ranefs</span>[<span class="no">j</span>,] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tmod</span>)[<span class="fl">9</span>]$<span class="no">varcor</span>),<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)[<span class="fl">7</span>]$<span class="no">sigma</span>^<span class="fl">2</span>)
<span class="no">fixefs</span>[<span class="no">j</span>,] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">tmod</span>)))[<span class="fl">1</span>:<span class="fl">6</span>]

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">j</span>,<span class="st">"done"</span>))

}</pre></body></html></div>
</div>
<div id="plot-results" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-results" class="anchor"></a>Plot results</h4>
<p>We now calculate the quantiles of the reference distribution, calculate p values and produce the plots used in the paper</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># quantiles of reference distribution</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">fixefs</span>[,<span class="fl">1</span>],<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))
<span class="co">#&gt;     2.5%    97.5% </span>
<span class="co">#&gt; 2.245197 2.478587</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">fixefs</span>[,<span class="fl">2</span>],<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))
<span class="co">#&gt;       2.5%      97.5% </span>
<span class="co">#&gt; 0.04420932 0.10535789</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">fixefs</span>[,<span class="fl">3</span>],<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))
<span class="co">#&gt;         2.5%        97.5% </span>
<span class="co">#&gt; -0.077605512 -0.002002808</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">fixefs</span>[,<span class="fl">4</span>],<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))
<span class="co">#&gt;         2.5%        97.5% </span>
<span class="co">#&gt; -0.000169437  0.006084938</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">fixefs</span>[,<span class="fl">5</span>],<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))
<span class="co">#&gt;        2.5%       97.5% </span>
<span class="co">#&gt; -0.05608891 -0.02012636</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">fixefs</span>[,<span class="fl">6</span>],<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))
<span class="co">#&gt;         2.5%        97.5% </span>
<span class="co">#&gt; 0.0009240526 0.0058891721</span>

<span class="co"># p values</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)$<span class="no">coefficients</span>$<span class="no">cond</span>[,<span class="fl">1</span>][<span class="fl">1</span>]<span class="kw">&lt;</span><span class="no">fixefs</span>[,<span class="fl">1</span>])/(<span class="no">n.rand</span>+<span class="fl">1</span>)
<span class="co">#&gt; [1] 0.8481518</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)$<span class="no">coefficients</span>$<span class="no">cond</span>[,<span class="fl">1</span>][<span class="fl">2</span>]<span class="kw">&lt;</span><span class="no">fixefs</span>[,<span class="fl">2</span>])/(<span class="no">n.rand</span>+<span class="fl">1</span>)
<span class="co">#&gt; [1] 0.02697303</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)$<span class="no">coefficients</span>$<span class="no">cond</span>[,<span class="fl">1</span>][<span class="fl">3</span>]<span class="kw">&lt;</span><span class="no">fixefs</span>[,<span class="fl">3</span>])/(<span class="no">n.rand</span>+<span class="fl">1</span>)
<span class="co">#&gt; [1] 0.999001</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)$<span class="no">coefficients</span>$<span class="no">cond</span>[,<span class="fl">1</span>][<span class="fl">4</span>]<span class="kw">&lt;</span><span class="no">fixefs</span>[,<span class="fl">4</span>])/(<span class="no">n.rand</span>+<span class="fl">1</span>)
<span class="co">#&gt; [1] 0</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)$<span class="no">coefficients</span>$<span class="no">cond</span>[,<span class="fl">1</span>][<span class="fl">5</span>]<span class="kw">&lt;</span><span class="no">fixefs</span>[,<span class="fl">5</span>])/(<span class="no">n.rand</span>+<span class="fl">1</span>)
<span class="co">#&gt; [1] 0.5004995</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)$<span class="no">coefficients</span>$<span class="no">cond</span>[,<span class="fl">1</span>][<span class="fl">6</span>]<span class="kw">&lt;</span><span class="no">fixefs</span>[,<span class="fl">6</span>])/(<span class="no">n.rand</span>+<span class="fl">1</span>)
<span class="co">#&gt; [1] 0.8981019</span></pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># plot of fixed effects</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">fixefs</span>[,<span class="fl">1</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.1</span>,<span class="fl">2.6</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"Intercept"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>)<span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">1</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">fixefs</span>[,<span class="fl">2</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0.2</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"Main effect of sex"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>)<span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">2</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">fixefs</span>[,<span class="fl">3</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.15</span>,<span class="fl">0.05</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"Main effect of age"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>)<span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">3</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">fixefs</span>[,<span class="fl">4</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.005</span>,<span class="fl">0.015</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"Main effect of age squared"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>)<span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">4</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">fixefs</span>[,<span class="fl">5</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.1</span>,<span class="fl">0</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"sex * age"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>)<span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">5</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">fixefs</span>[,<span class="fl">6</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.005</span>,<span class="fl">0.02</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"sex * age squared"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>)<span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">6</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)</pre></body></html></div>
<p><img src="CaseStudyOne_files/figure-html/plot_fixefs-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># plot of random effects</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">3</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">ranefs</span>[,<span class="fl">1</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0.15</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"Individual"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)[<span class="fl">9</span>]$<span class="no">varcor</span>)[<span class="fl">1</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">ranefs</span>[,<span class="fl">2</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0.15</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"Group"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)[<span class="fl">9</span>]$<span class="no">varcor</span>)[<span class="fl">2</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">ranefs</span>[,<span class="fl">3</span>],<span class="kw">col</span><span class="kw">=</span><span class="st">"light grey"</span>,<span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0.15</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">"Time Period"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Estimate"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">cex.main</span><span class="kw">=</span><span class="fl">1.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod_deg2alt</span>)[<span class="fl">9</span>]$<span class="no">varcor</span>)[<span class="fl">3</span>],<span class="fl">2</span>),<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>),<span class="kw">lwd</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"red"</span>)</pre></body></html></div>
<p><img src="CaseStudyOne_files/figure-html/plot_random_effs-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># plot of predicted change in degree with age</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>),<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">3</span>))
<span class="no">x</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">0.01</span>)
<span class="no">yf</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">1</span>]+<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">3</span>]*<span class="no">x</span>+<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">4</span>]*<span class="no">x</span>^<span class="fl">2</span>
<span class="no">ym</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">1</span>]+<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">2</span>]+(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">3</span>]+<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">5</span>])*<span class="no">x</span>+(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">4</span>]+<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/fixef.html">fixef</a></span>(<span class="no">mod_deg2alt</span>))[<span class="fl">6</span>])*<span class="no">x</span>^<span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">yf</span>)+<span class="fl">1</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"dodger blue"</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"l"</span>,<span class="kw">lwd</span><span class="kw">=</span><span class="fl">4</span>,<span class="kw">ylab</span><span class="kw">=</span><span class="st">"Predicted Degree"</span>,<span class="kw">xlab</span><span class="kw">=</span><span class="st">"Age"</span>,<span class="kw">cex.lab</span><span class="kw">=</span><span class="fl">1.5</span>,<span class="kw">cex.axis</span><span class="kw">=</span><span class="fl">1.3</span>,<span class="kw">las</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">15</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">ym</span>)+<span class="fl">1</span>,<span class="kw">col</span><span class="kw">=</span><span class="st">"firebrick"</span>,<span class="kw">lwd</span><span class="kw">=</span><span class="fl">4</span>)

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">50</span>){
  <span class="no">yf</span><span class="kw">&lt;-</span><span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">1</span>]+<span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">3</span>]*<span class="no">x</span>+<span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">4</span>]*<span class="no">x</span>^<span class="fl">2</span>
  <span class="no">ym</span><span class="kw">&lt;-</span><span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">1</span>]+<span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">2</span>]+(<span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">3</span>]+<span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">5</span>])*<span class="no">x</span>+(<span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">4</span>]+<span class="no">fixefs</span>[<span class="no">i</span>,<span class="fl">6</span>])*<span class="no">x</span>^<span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">yf</span>)+<span class="fl">1</span>,<span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span>(<span class="st">"dodgerblue"</span>,<span class="fl">0.05</span>))
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">ym</span>)+<span class="fl">1</span>,<span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span>(<span class="st">"firebrick"</span>,<span class="fl">0.05</span>))
}</pre></body></html></div>
<p><img src="CaseStudyOne_files/figure-html/plot_preds-1.png" width="576" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="references" class="section level4">
<h4 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h4>
<ul>
<li>Delahay, R. J., Walker, N., Smith, G. S., Wilkinson, D., Clifton-Hadley, R. S., Cheeseman, C. L., … Chambers, M. A. (2013). Long-term temporal trends and estimated transmission rates for Mycobacterium bovis infection in an undisturbed high-density badger (Meles meles) population. Epidemiology and Infection, 141(07), 1445–1456.</li>
<li>McDonald, J. L., Robertson, A., &amp; Silk, M. J. (2018). Wildlife disease ecology from the individual to the population: Insights from a long-term study of a naturally infected European badger population. Journal of Animal Ecology, 87(1). <a href="doi:10.1111/1365-2656.12743" class="uri">doi:10.1111/1365-2656.12743</a>
</li>
<li>Weber, N., Carter, S. P., Dall, S. R. X., Delahay, R. J., McDonald, J. L., Bearhop, S., &amp; McDonald, R. A. (2013). Badger social networks correlate with tuberculosis infection. Current Biology, 23(20), R915–R916.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Silk, Daniel Padfield.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
